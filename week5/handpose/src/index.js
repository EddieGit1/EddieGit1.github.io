let model
let videoWidth, videoHeight
let ctx, canvas
const log = document.querySelector("#array")
const VIDEO_WIDTH = 320
const VIDEO_HEIGHT = 205

let currentPredictions

//knn
const k = 3
const knn = new kNear(k)

//paper
knn.learn([131.82377326391526, 187.46441487654872, -0.00044986605644226074, 115.56450012955402, 165.5487623947684, -4.177557468414307, 107.42358905177892, 147.81655041193767, -9.707779884338379, 103.08705246231538, 132.14873361698233, -12.925580978393555, 99.06077084637488, 120.64353686710166, -15.50398063659668, 129.3468294142964, 140.61428579565995, -25.61490249633789, 138.12658991797943, 114.07831031067045, -32.601078033447266, 142.94527315685175, 99.01770204243408, -33.839202880859375, 146.32316539347653, 88.17363087595038, -33.555606842041016, 143.9944517772247, 143.17904554346163, -22.854021072387695, 155.7452532087012, 114.66522636005055, -30.51291847229004, 160.78442762770945, 99.29095131787261, -29.400659561157227, 163.5307488672845, 89.33620907021536, -27.824552536010742, 155.7734775458338, 146.90048598447493, -18.644241333007812, 167.77341311720647, 122.6417265701474, -23.880939483642578, 173.06889889330702, 108.35511333111668, -22.01811408996582, 175.37042357481647, 99.13259777549932, -20.28462028503418, 164.3406036103277, 151.85133454598866, -14.031845092773438, 174.44030758053543, 132.28187193349515, -16.845863342285156, 177.90894168206444, 120.85227824326736, -16.182884216308594], "paper")
knn.learn([183.47263389061186, 144.08512330853483, -0.0004328489303588867, 160.75267748843112, 132.09099950378598, -6.16458797454834, 145.0907853922989, 113.1574909851825, -10.509963989257812, 132.87474038067893, 94.77302465654897, -15.112222671508789, 120.95202271750746, 81.46470804232935, -20.170045852661133, 167.0130473131546, 90.57509780546084, -9.291513442993164, 164.41500359911632, 66.49865564153178, -14.0430269241333, 163.80911996262938, 49.382989321193534, -17.89527702331543, 163.44876274675534, 34.56513516582212, -21.158992767333984, 181.9844727754754, 89.88336738584738, -10.94275188446045, 184.31688405429088, 62.81527634536857, -16.03614044189453, 186.77064607849726, 43.29051806437408, -20.245746612548828, 189.07384805757846, 27.824716467880137, -23.44721031188965, 194.74804160005075, 93.95610887577995, -13.266551971435547, 200.87820001539103, 70.96632178715493, -18.432497024536133, 206.04056662917995, 53.458569406057855, -22.0141544342041, 209.76840256597026, 39.18385528408584, -24.773944854736328, 205.17266601201248, 102.49280638277392, -16.290090560913086, 213.8114596958825, 86.50069162270843, -21.11443519592285, 219.39545489253447, 75.08213618807612, -23.90045928955078], "paper")
knn.learn([173.54835126108355, 162.63325474827388, -0.0011249333620071411, 145.62690949443936, 145.68753359952854, -5.263341426849365, 127.98612010631848, 121.97516657958616, -8.443181991577148, 115.4217418395861, 98.89597098290103, -12.10407829284668, 101.6017565020653, 80.51997169086742, -16.078561782836914, 152.36203199037143, 96.44874061071309, -5.125622272491455, 147.6545118706292, 69.30363882875733, -9.414054870605469, 144.87898609375503, 49.120392795490034, -13.420042991638184, 142.30346465363655, 31.25325900986715, -16.913021087646484, 169.88580052620912, 95.73619201017908, -7.737381935119629, 168.99348225142916, 65.11935175555661, -12.349349021911621, 168.9087181061713, 41.67400637684185, -17.464035034179688, 168.77677104378552, 22.746669245300254, -21.632667541503906, 185.42611582343469, 100.30949379840388, -11.270298957824707, 189.39743065715533, 73.65857555376331, -16.72609519958496, 192.95626076386537, 52.95272078981633, -21.87705421447754, 194.83207068320584, 35.90830921340375, -25.923004150390625, 198.8810871469046, 109.91912198915297, -15.453224182128906, 207.38721742367738, 91.20999093058697, -20.745403289794922, 212.95577789197606, 77.22543005841143, -24.75955581665039], "paper")
knn.learn([154.7926689924348, 171.90807490580494, -0.0005180388689041138, 130.52905760807982, 146.76885448579708, -4.007681846618652, 122.07273281826409, 115.72439038740448, -6.17734956741333, 118.66043174896558, 89.38074556077774, -9.53991985321045, 114.542329895788, 67.77072487939564, -13.441140174865723, 159.1148103112615, 94.41250658634748, -1.5545988082885742, 163.25560225764636, 65.1121061465851, -4.722956657409668, 167.3331273256062, 43.523051566711594, -8.127853393554688, 170.9612634687323, 25.32570330348561, -11.515056610107422, 177.58641224240475, 99.4540941231004, -5.35146427154541, 188.32919352111387, 67.3919313011216, -8.771692276000977, 196.83120764285712, 43.35968030624719, -13.48002815246582, 203.89051166165933, 24.252415916722015, -17.153303146362305, 191.90257060646633, 109.41710460850621, -10.324296951293945, 206.24014722471924, 82.5691534662313, -14.430076599121094, 217.98603008624696, 60.636879697529444, -18.475658416748047, 227.19202350978819, 42.13540776414744, -21.68449592590332, 201.85293369530012, 124.77078121986625, -16.116790771484375, 219.09074030366511, 107.26519354039723, -20.67340850830078, 231.64268627859587, 92.95128806370116, -23.828487396240234], "paper")
knn.learn([165.80416608437147, 156.12839660060138, -0.0006737932562828064, 143.63238810843075, 133.43302575152904, -5.021719455718994, 132.64926590315355, 106.03152917763214, -7.522960186004639, 125.70082312063104, 82.08455820736611, -10.758959770202637, 119.32809067343962, 63.96875209174453, -14.251707077026367, 163.71419415080268, 80.2266639126606, 0.39382708072662354, 167.79916873033594, 53.64893346731212, -0.5715206861495972, 171.79420374778485, 35.44583796073358, -1.6621558666229248, 175.44861556367525, 21.193611450247154, -3.1297767162323, 182.059001415068, 83.48852507411614, -1.2283862829208374, 192.1345065759773, 54.51473184601782, -1.6919035911560059, 200.0367799556207, 34.7894272432295, -4.038605213165283, 205.98729866886902, 20.25533959243829, -6.007518768310547, 196.674987425534, 91.69580862314412, -4.215336799621582, 209.276081186769, 66.57613109149938, -6.15952205657959, 218.53374190455273, 48.80220486896165, -8.854559898376465, 225.0738169469032, 35.407746962358345, -10.676501274108887, 208.0460358886205, 104.67335046664243, -8.092137336730957, 221.60607379653447, 87.36966285919935, -11.066783905029297, 231.21900189247182, 74.72551846730626, -13.345325469970703], "paper")
knn.learn([159.37241368527697, 177.27072463530556, -0.0009694695472717285, 129.40116354648205, 161.9424490900444, -2.9746742248535156, 112.40437084349094, 139.22172911036574, -7.6448445320129395, 103.96910118057914, 114.82287071797042, -9.954832077026367, 97.94839533470733, 97.3934329255205, -11.84682559967041, 132.7618806589706, 120.69360751955632, -23.13275718688965, 134.59100280863152, 84.1126839642956, -27.77950668334961, 136.99432465808337, 61.661346172876826, -28.018083572387695, 139.1347021702064, 44.80838309657999, -27.361488342285156, 153.87154410570295, 118.37500987702781, -19.52234649658203, 157.7066758307293, 78.38993842413754, -25.53635597229004, 160.44117034538687, 53.20984498332367, -24.006322860717773, 162.56502422852944, 34.97120943999773, -22.105430603027344, 171.37140953679005, 119.28735508099982, -14.053776741027832, 177.04499784612995, 83.7902771992048, -18.034290313720703, 179.9878237058127, 60.77738408146828, -16.025096893310547, 181.25610884582932, 44.567516368357275, -13.803518295288086, 184.9750111643618, 122.25800152988046, -7.9000654220581055, 191.86550379301423, 95.35622302072225, -10.098625183105469, 194.23363639513707, 78.76525576221546, -9.00575065612793], "paper")
knn.learn([124.40272765194413, 119.62436467809304, -0.0007343366742134094, 118.96568691232673, 90.27522327604103, -4.6343464851379395, 126.71104232941931, 65.41415807474493, -7.390061855316162, 135.7654030414061, 45.56227394749112, -10.812226295471191, 142.26049787158706, 28.49399125929996, -14.560256004333496, 167.10909144864317, 70.00670435987116, -1.9675648212432861, 187.58921171767383, 55.02872816989294, -4.106141567230225, 202.06630356193213, 45.03150548231872, -6.33406925201416, 214.28593537912622, 36.68399871647696, -8.667045593261719, 176.7363466374379, 83.51623998282497, -4.763686656951904, 202.65489688165604, 68.76196709435975, -7.28041934967041, 221.1414725545249, 58.898495837736164, -10.998653411865234, 235.45037726416652, 51.350705007448646, -13.982454299926758, 180.94869863741428, 98.01234876911437, -8.607641220092773, 206.043349911419, 87.87945144668464, -12.256406784057617, 225.11480886178254, 80.89865516303348, -15.711959838867188, 239.66099893524967, 74.95729718238323, -18.329572677612305, 179.83935580129435, 113.10497958540228, -13.186813354492188, 200.94757834512734, 109.53339913042738, -17.181169509887695, 216.72978617718667, 106.73750270459671, -19.872364044189453], "paper")
knn.learn([133.82361837441022, 121.3365195790214, -0.0007702633738517761, 129.5685335408093, 95.89415425276493, -2.8412296772003174, 135.88744798177783, 73.59894258227055, -4.5786638259887695, 143.16052684109292, 55.98241607911099, -7.103240489959717, 147.46045271942404, 41.126520986569936, -10.062566757202148, 172.54853190169314, 75.99553127810186, -0.19963955879211426, 190.604150783821, 61.51002526108726, -1.1854771375656128, 202.9974566114999, 51.984848368639824, -2.3574724197387695, 213.01081496731217, 44.06097956277833, -3.879298686981201, 182.4985319306926, 87.63232274480333, -2.9875221252441406, 205.43632570227686, 73.15766106961705, -4.632776260375977, 221.02914954489353, 63.697790684981435, -7.120481014251709, 232.46007265752712, 56.622097429882906, -8.757165908813477, 187.26529273199168, 100.88521210198097, -6.7194414138793945, 210.27440418144704, 91.8172257476784, -9.371962547302246, 226.9118568802948, 85.54661271707815, -11.538118362426758, 239.23812341016608, 80.41534786519021, -12.892206192016602, 186.48389357503527, 114.99908345127339, -11.011646270751953, 206.30798318001914, 112.17046760496663, -14.38414478302002, 220.4902485215806, 109.73895898999342, -16.374828338623047], "paper")
knn.learn([202.70090093723863, 108.353612108162, -0.0006082430481910706, 177.22337289276336, 123.52974581074655, -4.4224066734313965, 152.22985954035633, 121.41727275399676, -6.753836154937744, 131.52753771862706, 112.62277697562772, -9.068528175354004, 114.19864040094492, 106.12404886304384, -11.456867218017578, 143.57249640913082, 95.96473152652172, -6.167474269866943, 120.54017803567875, 81.67722653013907, -8.074092864990234, 105.54406425832335, 70.8201387146168, -6.7806806564331055, 93.39980238070814, 62.262627334894944, -5.57420539855957, 151.87097409886354, 80.80163379158202, -7.2974958419799805, 127.98161034251325, 62.3402325302291, -9.98469066619873, 111.77185538684552, 48.74287695629462, -10.060859680175781, 99.47546179270446, 38.37222527242337, -9.267478942871094, 162.64303738817435, 69.17239547697919, -9.01819133758545, 142.99669432950688, 49.63274757695349, -12.02827262878418, 128.18479230222485, 34.98688978846332, -12.995601654052734, 116.0623884410511, 24.313159692579532, -13.183272361755371, 175.9294153868613, 60.9461964509408, -11.16655158996582, 163.08406641527645, 43.3328413819459, -14.288350105285645, 154.20152996725022, 30.98602495907251, -15.512140274047852], "paper")
knn.learn([161.75642045108648, 189.95383984957908, -0.0009040161967277527, 134.7685322416154, 173.78665643953286, -7.4183807373046875, 117.80304157333065, 151.45921624187474, -12.469659805297852, 106.3295657996427, 127.37132881247297, -16.027917861938477, 95.15818492770984, 107.57399342910051, -19.150625228881836, 137.49474205842526, 125.46567941486128, -16.823766708374023, 130.3350152609906, 93.58811552707841, -22.335567474365234, 126.8632876331029, 72.24733280692415, -25.76120376586914, 123.99147776892113, 54.32752364135148, -28.16538429260254, 156.04849221726892, 122.05379155765165, -15.011772155761719, 153.59809503119047, 86.37369947470114, -21.081626892089844, 152.0417416855536, 62.10847210857687, -24.189714431762695, 150.73090985262075, 42.50053625664888, -26.300457000732422, 171.7112708092305, 123.27734011410385, -12.961956024169922, 173.9432407356616, 92.34888239445989, -17.931472778320312, 175.35799514512536, 69.5475511063569, -20.63939666748047, 175.68494634900034, 50.98675016549663, -22.520334243774414, 184.1974598915091, 128.97360230292372, -11.214818954467773, 191.39164844904172, 106.02928446120511, -14.700780868530273, 195.02592013800992, 90.05243754386323, -16.608816146850586], "paper")


//rock
knn.learn([148.48159737703133, 131.5640878330667, -0.0007931143045425415, 128.569161004022, 123.15076301841037, -23.42534065246582, 113.78439799226763, 105.32714395857133, -38.470542907714844, 115.96917052650309, 86.03009646730634, -51.820003509521484, 129.35205346281933, 76.14831431871215, -60.380088806152344, 127.50857737231813, 72.58439347017668, -16.846330642700195, 131.58086109492228, 63.52285664593924, -45.29719161987305, 133.0458826306772, 78.02678492576129, -46.144981384277344, 132.55984054275405, 85.2555169420014, -32.92955780029297, 143.6404670675427, 73.17105925084121, -14.089977264404297, 147.53562260943468, 66.50745617021879, -45.45360565185547, 145.5929077581178, 86.797040315323, -41.147830963134766, 143.12065192710475, 91.23820904569773, -24.224010467529297, 158.9304639702914, 77.9681444098209, -16.095417022705078, 161.05744682165488, 75.21822601500601, -44.745845794677734, 156.31304783962386, 93.59291647910544, -40.51062774658203, 153.77730674860598, 95.68137157396193, -27.65277671813965, 172.24277932504526, 85.0219083683301, -19.685203552246094, 172.587514163563, 84.69370481770238, -40.18779373168945, 167.0372771257579, 96.94517463452215, -34.059024810791016], "rock")
knn.learn([144.87473116163065, 135.16947366377246, 0.0003771260380744934, 124.52445959247906, 126.4749493976828, -12.201713562011719, 111.03337217532012, 106.48526480997481, -18.692623138427734, 115.25290568186787, 87.58516346603484, -26.124305725097656, 129.4638762165961, 81.74114058101023, -30.923044204711914, 123.60151747694513, 76.79588830475132, 4.939024448394775, 121.26055810151958, 64.29859486048066, -23.00640869140625, 122.8829038402738, 79.28834783773095, -28.95142364501953, 126.18531070016832, 88.2285175603883, -17.1712703704834, 137.93896472185904, 77.2058205532894, 4.116616725921631, 136.10838544769496, 67.66855548195396, -23.47168731689453, 135.86243265018692, 89.27160435476605, -24.508331298828125, 138.71325258642187, 94.81695583651441, -9.348358154296875, 152.89884477928015, 81.33238900287091, -1.5219604969024658, 150.87902608508566, 75.14580377046167, -27.39082908630371, 147.81451070493205, 95.49191855755706, -27.033098220825195, 150.0188785068392, 100.3405824623597, -14.975654602050781, 167.664855747931, 88.18497715687081, -7.916988372802734, 164.49469332021684, 83.46695969799127, -24.139610290527344, 158.9515877141238, 96.43406924309002, -20.447608947753906], "rock")
knn.learn([135.8894524253936, 121.04785728324946, -0.0000993683934211731, 119.06219933917815, 118.8372498220138, -19.668027877807617, 103.10333287693629, 105.53799664674716, -32.011722564697266, 102.43757259240856, 91.93768085574399, -43.45238494873047, 111.99840800165381, 85.8404741180216, -50.7596549987793, 111.40109376460109, 74.16717122802035, -9.362417221069336, 108.53419605775619, 70.50476869560217, -36.9984130859375, 112.02157905561324, 82.39309309555749, -34.512596130371094, 115.75786429007188, 88.9506466588767, -18.90608787536621, 124.8816606190815, 71.5829668906762, -9.412440299987793, 120.3106301618353, 70.7576904960095, -40.06752395629883, 123.02818966276826, 87.44565923588122, -33.32687759399414, 126.34936508213698, 90.09831513534293, -16.39637565612793, 137.97824301071705, 72.81680246202487, -14.832225799560547, 131.93947676932305, 75.62790189337886, -42.55830383300781, 132.27560031339328, 91.57390108926926, -36.01636505126953, 135.46966339150396, 92.42590998518259, -22.764368057250977, 150.40415982098938, 76.59543109143608, -21.830949783325195, 144.3907078665431, 79.13222755861868, -42.89848709106445, 141.3730349188907, 91.08008538832888, -35.42995834350586], "rock")
knn.learn([156.89627511076023, 135.3492903460364, 0.0011634305119514465, 139.2564828802366, 126.84195473247769, -16.249284744262695, 125.1034655023901, 111.02213895860905, -29.276531219482422, 127.92985976296376, 100.57246467563674, -43.462646484375, 141.2998525078868, 102.09844015229282, -55.71127700805664, 138.95268031900207, 82.27562885793418, -10.236198425292969, 132.5650321237071, 74.82270393719114, -40.34718704223633, 132.86475457142197, 86.38082085282278, -50.11943817138672, 136.50766844906144, 94.54800547992704, -47.3175048828125, 153.48319467240722, 82.59809092454054, -12.352936744689941, 147.8296569471022, 76.29869623583393, -43.861480712890625, 145.468982632295, 92.38180239243331, -44.00822830200195, 147.3014279158854, 98.06003651969439, -33.847412109375, 167.31761089438797, 86.68284834969751, -19.609132766723633, 158.99531262072526, 83.86646863615017, -46.47807693481445, 153.77929369553488, 99.61293474761386, -41.720489501953125, 155.64063435280056, 103.648855779945, -30.94279670715332, 179.24256576433464, 94.56212815202325, -28.69500732421875, 170.75703745242532, 91.86954198974597, -47.31704330444336, 163.84310170649098, 102.15842935288968, -42.61857223510742], "rock")
knn.learn([147.27785521199456, 131.09172903298162, 0.0008464977145195007, 128.98126269892836, 121.7648692338523, -12.067949295043945, 116.23824280863737, 104.17129753516176, -19.38941764831543, 120.16367347475092, 92.70587772827568, -29.104326248168945, 129.71529496700478, 95.18748890407143, -39.08252716064453, 124.42000872971909, 81.30008413227094, -1.594940423965454, 117.97913561592927, 72.27968995587521, -31.886198043823242, 120.91324481000407, 85.17935418957659, -46.73275375366211, 126.52740166115514, 92.10526007488056, -47.63446044921875, 137.6348020600528, 80.69001528560192, -4.476086616516113, 132.8312591651572, 73.87243574832459, -34.483856201171875, 134.18085699212875, 90.48590159896548, -37.521385192871094, 138.14073271390015, 94.16906429332383, -28.426280975341797, 151.1723813260982, 83.27739193736495, -12.134671211242676, 144.98638914011428, 78.79533715026541, -36.72140121459961, 142.92658008079843, 94.60999541095892, -32.692935943603516, 146.1866549297387, 97.53852893863258, -22.167543411254883, 164.22711469763152, 89.232023276458, -21.466197967529297, 156.38251497126487, 86.20025109856951, -37.750850677490234, 151.8247234247296, 96.68304243631499, -32.79755401611328], "rock")
knn.learn([138.57920027490078, 142.19757823108074, 0.0007354766130447388, 121.665204818977, 133.61039931922892, -13.776823043823242, 109.81102492320953, 118.35968856626278, -23.855682373046875, 109.29052535383384, 103.33728204307246, -34.090171813964844, 116.83894552533734, 95.52272390586458, -41.65727233886719, 120.05846957764498, 93.02433285563228, -11.031854629516602, 116.4531739375401, 82.59908397573003, -39.871578216552734, 116.18036453223411, 97.42922829897712, -44.31041717529297, 117.63861040147295, 107.3108908672255, -34.24089050292969, 132.17688003234804, 92.85413836122927, -12.537291526794434, 128.81130470729946, 84.9155652607233, -41.57908248901367, 127.52038153653413, 104.23713618201636, -40.88396453857422, 128.642103248561, 110.94067124804191, -29.026290893554688, 144.4362833405221, 96.21851536841471, -18.285701751708984, 140.21054786966738, 90.59966898946873, -44.97407531738281, 136.74309381202778, 108.9829298403531, -43.168582916259766, 137.68726394570885, 115.02888185975102, -33.31079864501953, 156.24442249812253, 101.86573187634357, -24.95606231689453, 151.85453999000177, 97.49809942182218, -43.36885452270508, 146.94363765070696, 109.58348772817442, -39.618289947509766], "rock")
knn.learn([148.71535993556196, 152.54076724180183, -0.00002088397741317749, 130.29242161249306, 144.08539570417918, -16.910778045654297, 117.76184165606048, 128.28794198718137, -29.8792667388916, 119.41051785078923, 112.53158324132613, -41.97850036621094, 131.77857637542888, 105.73940481952968, -50.14130401611328, 134.88039434281055, 104.7765291232991, -18.487497329711914, 132.1456068291042, 96.63698245843443, -49.43276596069336, 132.61947245134647, 111.48160871619433, -49.748294830322266, 134.8241694216431, 118.26837779458529, -36.00938034057617, 147.9349510631355, 105.6927090015232, -19.06881332397461, 145.07087840152238, 99.77094263390293, -50.357452392578125, 143.79533098519974, 117.60403882681676, -44.87949752807617, 144.9555030797177, 121.1849234090466, -29.771453857421875, 160.6549083804608, 109.67133717412123, -23.84156036376953, 156.41722200060738, 105.26332558021721, -52.242366790771484, 152.94199290651144, 121.4600010199464, -46.738407135009766, 154.30448894497704, 124.31004619418059, -35.32697677612305, 171.88630431719858, 115.36058103802235, -29.593074798583984, 168.25196497930423, 112.20313835912795, -50.688846588134766, 163.36301130825763, 123.03663087994236, -43.431270599365234], "rock")
knn.learn([147.6195507936882, 151.12174097977558, 0.0003965049982070923, 130.00758608351407, 143.9148448357465, -16.98863410949707, 116.85252891664068, 128.99864549117737, -29.852842330932617, 117.81264547274102, 114.19941511685614, -41.77906799316406, 130.49854328375994, 108.76773376361284, -49.14297866821289, 132.5357442388704, 102.98058232256913, -16.0959415435791, 128.10090793276623, 95.6635223712278, -48.29168701171875, 128.1866446734453, 110.89501586706807, -51.33176040649414, 130.18678905083448, 118.601811851466, -39.42129898071289, 145.1905768420282, 104.02385680586875, -16.378015518188477, 141.23177838340155, 98.6339457002734, -47.7576904296875, 140.26302578053568, 116.77628460027525, -43.06288528442383, 141.308965879347, 120.98518344199486, -28.184106826782227, 157.35652802539045, 108.04276032527068, -21.128915786743164, 151.95017836688763, 104.5613931900812, -49.58714294433594, 148.6932859845258, 121.61692273285149, -44.39627456665039, 150.0087948960556, 125.00262494641407, -32.645870208740234, 168.02992936044475, 113.71732803394144, -27.021839141845703, 162.9290581304988, 111.59275826520572, -47.995567321777344, 158.18480595149248, 123.60841453465117, -40.842529296875], "rock")
knn.learn([144.40513629706703, 155.55046216322867, 0.0008993297815322876, 127.82457470816918, 151.54903133439376, -24.80262565612793, 112.84294255115407, 137.13668484348048, -41.1626091003418, 113.76459384993801, 122.22357341454611, -55.64114761352539, 125.72322326828751, 114.10489580089401, -63.91935729980469, 123.35122334039484, 100.87441381096662, -16.8100528717041, 122.61776129672596, 98.96045327123889, -48.22270202636719, 124.0217010332427, 107.99987927372133, -47.83939743041992, 124.5958614743495, 112.46288128193596, -33.1926383972168, 139.02251446537045, 99.64080761492633, -15.993731498718262, 136.3710831480678, 102.80241364661703, -52.939369201660156, 136.39120394722525, 120.99821559744251, -46.41590881347656, 136.81804319759135, 124.13795517089173, -28.287979125976562, 153.29411532111476, 103.11108097465157, -20.910737991333008, 148.05410139607025, 111.96958160189993, -53.18972396850586, 145.06601763283567, 128.69705376169568, -43.047550201416016, 145.65230531318682, 129.09801856013033, -26.496660232543945, 165.5852012264782, 109.22865108302764, -28.154481887817383, 159.75340092296994, 117.5744763696163, -50.41925048828125, 154.20482643429023, 129.94916186760432, -40.585609436035156], "rock")
knn.learn([138.65419847462823, 141.065004968525, -0.000302635133266449, 118.72179089385877, 134.72824267981724, -6.239630699157715, 106.26927461625256, 124.33181317260517, -8.488608360290527, 104.7785600873642, 113.13186909491401, -12.261963844299316, 110.69459760390606, 108.20902051940269, -14.641817092895508, 118.32144626146903, 99.95399893582446, 9.138566970825195, 114.07438512211735, 99.89548752043692, -10.327279090881348, 114.25814393448026, 114.73564903455758, -12.224671363830566, 115.20621397488698, 123.45541729181792, -0.9330482482910156, 131.71622694346198, 99.17368500461583, 7.806694030761719, 126.85171038121584, 104.39178079066164, -14.423280715942383, 126.32005842714474, 123.37598669010268, -16.589519500732422, 127.09822302435786, 129.960499023305, -5.437989234924316, 144.10783397203892, 102.16767597332857, 3.4375436305999756, 138.61494814885543, 108.41094224117212, -14.82076644897461, 136.53960457591984, 125.47630869948755, -14.933134078979492, 137.56356150466982, 130.8224018949827, -5.625784873962402, 155.90811244863812, 105.92169376591147, -1.5209057331085205, 150.87787339507128, 110.83408807391602, -12.320158004760742, 146.51083618883519, 122.55338859609152, -7.87334680557251], "rock")


//scissors
knn.learn([156.77336855066363, 154.18997430029816, -0.0009121298789978027, 135.80885287890752, 147.50021106344758, -15.75613784790039, 127.82056720264441, 137.7217490366063, -25.780433654785156, 137.63786938190518, 130.6048646451227, -32.51895523071289, 153.63767933715687, 127.40278488515567, -36.27010726928711, 136.0880020796896, 109.40227539892597, -25.457834243774414, 128.57219561711764, 88.27257636421326, -36.23123550415039, 126.03437045106863, 71.38567464567518, -42.25434494018555, 124.97657661501111, 55.87519098518451, -47.303375244140625, 154.26952588683656, 109.55412344442855, -24.249650955200195, 156.65256196645595, 92.88493333444114, -39.06961441040039, 162.43351464655044, 76.70217022698219, -50.94916915893555, 168.36999023226292, 60.85958156401112, -59.626708984375, 169.57403127348562, 115.05886124226842, -23.091297149658203, 175.0311785120696, 114.98868873310852, -38.66222381591797, 172.9333842412833, 122.55600636419624, -36.405601501464844, 171.06118131383892, 124.69229318303586, -32.06501388549805, 180.16861709659653, 124.32812202542328, -23.100778579711914, 180.02697940345467, 129.6744064834825, -33.39406967163086, 169.65198811862706, 143.2252622613578, -29.215747833251953], "scissors")
knn.learn([132.82494008812228, 183.73525252911145, -0.00034964829683303833, 116.59428720585778, 177.43533790449132, -13.314756393432617, 106.58570246137188, 164.78911407173317, -21.47376823425293, 115.00664249091044, 154.9188926466665, -28.30427360534668, 127.93116195397735, 148.40350442003017, -33.49882888793945, 110.78177393929322, 130.4016816654525, -13.547798156738281, 100.5744631524562, 108.41222099351818, -20.731321334838867, 94.00514021320465, 92.68922691284061, -24.64109230041504, 89.49421711383025, 78.9344737033643, -27.475730895996094, 127.27734934341909, 128.94172809529294, -13.201789855957031, 130.68660885237415, 105.3611732273262, -19.64295768737793, 135.48280253394273, 86.48942667925617, -26.07979965209961, 139.9195896870179, 69.89575966150136, -32.202919006347656, 141.31898898649513, 134.41672746983602, -13.819040298461914, 143.07235607246767, 129.7713308646643, -28.092668533325195, 136.63027124030782, 144.9335781296664, -28.265647888183594, 133.19163129517267, 153.73350438479858, -25.555389404296875, 151.88474823458813, 145.141697701804, -15.434513092041016, 150.51215975450316, 143.8204167787089, -26.82384490966797, 143.04835985237423, 155.27725719296907, -26.02566146850586], "scissors")
knn.learn([132.7966066486399, 181.5627813109995, -0.00035288184881210327, 116.69877090884319, 175.42801120520917, -15.30406379699707, 111.66961747529254, 160.36308143490183, -24.856876373291016, 125.71794349941405, 150.02212707409245, -32.43561553955078, 143.62397761731842, 144.86693863991178, -37.913970947265625, 120.76718610775401, 127.9053047976701, -13.776857376098633, 114.6237538688391, 106.1762477875989, -21.839487075805664, 109.55713457382744, 90.34651802650882, -27.39842987060547, 106.31512377575028, 76.43997417197724, -31.30217742919922, 137.4578277265103, 127.89562430364217, -13.393868446350098, 144.19176850092467, 104.94494474384533, -21.3147029876709, 148.84820057778566, 86.92743393762785, -29.484304428100586, 152.62857439516318, 71.91591899069107, -35.84953308105469, 150.4050806420767, 135.0771857525636, -14.517395973205566, 155.29576138010847, 128.1533009416012, -30.20511817932129, 146.86104356956125, 139.87467887372787, -34.07261657714844, 140.98555840847504, 147.88581565066096, -33.443077087402344, 159.3571919126902, 146.8967527557462, -16.551950454711914, 159.38094481316176, 144.7277480444263, -29.62786865234375, 149.15644609469956, 157.1857993713743, -31.264301300048828], "scissors")
knn.learn([133.88950272511593, 173.2888211539467, -0.0002412945032119751, 116.89521708452266, 166.9634366558177, -11.763093948364258, 108.11094438963339, 150.78417438597324, -20.05223274230957, 118.93128548755897, 140.3916646903934, -27.751550674438477, 135.33477558082853, 136.6874523626477, -33.718421936035156, 120.16846098122862, 118.70307713884378, -7.742951393127441, 114.8784278181093, 98.56422955446473, -14.161771774291992, 111.27205822192643, 83.0082398947278, -17.61020851135254, 109.60349670031209, 68.9205310543224, -19.821889877319336, 136.19446214739287, 119.17930049575263, -8.892481803894043, 143.02126754243298, 98.4133124938979, -14.234945297241211, 149.04589322280802, 80.59846245207727, -20.514368057250977, 154.49693465574464, 66.16077825840664, -25.7120304107666, 148.84598984339624, 126.7493718577344, -11.487743377685547, 148.6226326162308, 120.85602037261991, -26.495391845703125, 139.1892356835182, 132.13886529430937, -29.684064865112305, 134.53548332650996, 139.76805241704423, -28.188732147216797, 157.72579851096012, 138.9271588588069, -14.679750442504883, 152.90410155551965, 136.0271575008705, -27.506582260131836, 141.34661485275194, 146.39427136256472, -28.798458099365234], "scissors")
knn.learn([149.34749363812887, 181.33706054585676, 0.00003349781036376953, 135.66013186711172, 172.58078734281727, -15.601243019104004, 134.08080224444058, 156.8324146552768, -24.435842514038086, 152.4585273923118, 147.7764156742751, -30.786760330200195, 172.76847394843745, 144.7171260559552, -34.60598373413086, 142.40194006474212, 121.122792173214, -13.050188064575195, 138.0979768815765, 96.97410338084643, -22.39658546447754, 134.82332937234358, 77.81730205244803, -28.97300910949707, 133.637633682857, 60.51204354543698, -33.55406188964844, 160.20235756586456, 122.22668908242251, -11.84946346282959, 168.58314711778505, 98.37520933957585, -20.121322631835938, 174.17728698786777, 76.94844524071664, -29.08806610107422, 178.82458647333027, 57.711379750529645, -36.533016204833984, 173.7993393413064, 130.2948031825535, -12.177228927612305, 178.12868163210328, 127.82338826200117, -27.863773345947266, 168.53185981645518, 145.31018618700588, -27.694602966308594, 161.33395359315065, 156.0224281110708, -24.01116371154785, 182.34368597266499, 142.74804195730798, -13.615907669067383, 181.4801724243475, 144.0285107215779, -27.372167587280273, 172.30911518800667, 154.70621570138456, -27.28482437133789], "scissors")
knn.learn([147.2266449876926, 191.48128701045786, -0.0003398582339286804, 130.425081457139, 187.84671586753782, -18.044679641723633, 122.67753306054459, 177.2959869545362, -28.39697265625, 134.12494503690908, 171.61143610615142, -35.04803466796875, 150.26571467070488, 166.4892125532996, -38.27121353149414, 130.045765329135, 135.87718425427715, -21.36998748779297, 121.26945974115489, 112.74781767388136, -31.95001792907715, 116.46513668597137, 92.6050140438294, -37.301082611083984, 114.57766050946509, 72.36180731474279, -41.98262023925781, 149.74944072862223, 134.38211126966775, -19.38624382019043, 157.74099024296422, 109.02785451998673, -29.239465713500977, 166.87854887526234, 86.28658324626504, -38.27018356323242, 176.30846691815242, 65.56392459022821, -47.01747512817383, 166.38051592194435, 140.2032790433899, -18.611230850219727, 167.90975359364182, 141.8994921611317, -35.6763801574707, 158.70040010412114, 163.242259942804, -32.291038513183594, 152.575475151803, 175.64160950406998, -26.75568389892578, 177.62309384264972, 151.34012749702188, -19.1695613861084, 176.0818727431943, 156.59369299266976, -34.065006256103516, 166.65435657483943, 170.58306672422663, -32.3926887512207], "scissors")
knn.learn([159.3656915906999, 179.8173681904313, -0.000901639461517334, 142.49196691171144, 174.96921389529408, -15.912817001342773, 136.5711897099556, 159.8820218384741, -25.00269317626953, 152.0776200095612, 147.44675019323304, -31.56855583190918, 170.72736490415818, 139.75087055843653, -35.15259552001953, 144.02259816824667, 123.89462336443194, -14.765972137451172, 137.54269036945874, 102.33489492144155, -23.282236099243164, 132.39499492638208, 84.63459680047025, -28.761688232421875, 129.49875781994257, 68.99059621880315, -32.58219909667969, 161.90539688422214, 122.54867940677644, -13.530743598937988, 169.06235456939442, 99.33203583937784, -21.39518928527832, 173.74737143844766, 78.85830120066873, -29.007341384887695, 177.0590149615634, 62.34779390383367, -35.044979095458984, 175.89588494506035, 129.27487438709346, -13.891139030456543, 180.57244684142717, 123.32448515278632, -30.568147659301758, 173.08057466357295, 140.10925688782248, -34.74189376831055, 167.71522247464543, 151.47492510297977, -33.69609832763672, 185.97759732701755, 141.09227012162563, -15.056995391845703, 186.41226333948578, 139.54751518269487, -30.974149703979492, 178.0400300161179, 152.06936142608913, -34.560482025146484], "scissors")
knn.learn([156.64760277285043, 179.5794620448582, -0.0002259090542793274, 138.40904277598867, 165.70813238263628, -13.925357818603516, 131.48111387309822, 143.2528402933686, -22.0139217376709, 145.49111736472997, 127.8579476003444, -28.359567642211914, 163.51854558666201, 119.6788863170268, -32.92170715332031, 142.6809437445686, 103.86564757285328, -11.280366897583008, 136.26305272041358, 76.59766809688847, -18.428401947021484, 131.42478870910617, 56.265214747298586, -23.718902587890625, 128.7845141076576, 37.733861196852125, -27.475244522094727, 162.67184393736642, 104.08903975943495, -10.993693351745605, 172.82758739061418, 75.3567560325714, -17.807249069213867, 179.54737131569135, 52.39713716806662, -24.102474212646484, 185.24912088624302, 32.562965406218034, -29.022327423095703, 177.01938073784981, 113.18045203825848, -12.425899505615234, 183.14776972102499, 101.85907037520273, -26.842411041259766, 171.03598733441504, 119.31054836736632, -31.139362335205078, 163.6690704743825, 131.30713454091241, -30.955904006958008, 186.99609739459052, 128.29299392352087, -14.7156982421875, 188.12083391213756, 120.54653549077102, -28.288015365600586, 175.9002219064354, 132.5827343346063, -31.791370391845703], "scissors")
knn.learn([133.6263528580109, 159.4080359422489, -0.0007454678416252136, 117.67402975570768, 149.37528486654986, -17.211816787719727, 114.6479124594947, 132.0258202559883, -26.40496826171875, 134.06374461529734, 123.7595571581054, -32.134525299072266, 155.82176108051004, 121.46400492229301, -34.125579833984375, 133.01732357786221, 98.56654024888043, -16.684711456298828, 131.2693555386352, 73.25673630253, -25.50896453857422, 130.85522582487744, 53.14418400938609, -31.22420883178711, 132.7492833634287, 36.074975874319364, -35.04493713378906, 152.2781236704387, 101.85958009612509, -14.10342025756836, 165.30392471290966, 79.37006438249644, -21.76561164855957, 176.84939191183005, 59.619545912706606, -29.37116050720215, 186.4366753436, 42.988053908008084, -36.01973342895508, 164.639920144467, 112.6015260356375, -13.013813972473145, 171.43776234811926, 108.28630036093212, -29.594688415527344, 159.52656518533806, 123.41533870789773, -32.2268180847168, 151.3247453621111, 133.2433140635834, -30.24273109436035, 170.9508272489695, 127.47690785150688, -12.84388542175293, 172.2192053307281, 127.10493719141286, -28.43482208251953, 162.0844665052971, 137.2245569792337, -31.118186950683594], "scissors")
knn.learn([154.55362703623612, 188.37595703901283, -0.002126529812812805, 158.1813271108899, 162.77289565794035, 6.04568338394165, 149.49373389299947, 140.11061667097192, 3.0685980319976807, 130.9129379824618, 129.49420563743757, 0.4282951354980469, 112.26760755457228, 123.95665961791448, -1.3356819152832031, 152.31188526388996, 116.78814674115577, -15.1094970703125, 151.83566108995916, 77.4180616275822, -22.121929168701172, 150.0294768041976, 49.944705948213816, -27.81583023071289, 146.61595572136054, 27.12768498305219, -32.67039489746094, 135.88825068410932, 124.90679735430535, -18.46123695373535, 113.19279632883506, 83.7362402900295, -28.261934280395508, 95.36676795479792, 53.74213313874324, -33.32426071166992, 81.04101939154054, 31.631887818814462, -37.56806945800781, 120.50774906464459, 138.12906438269943, -19.154523849487305, 92.43982588806335, 114.5003385137464, -18.056127548217773, 98.22509758590552, 121.97357422630849, -9.768232345581055, 107.14046801483764, 129.5477000341499, -5.650313377380371, 107.56948352416232, 152.53956993323857, -19.80425262451172, 86.5794483214898, 138.08712853630905, -15.044052124023438, 91.17658495571541, 143.34589855365923, -9.09080696105957], "scissors")


// video fallback
navigator.getUserMedia = navigator.getUserMedia ||navigator.webkitGetUserMedia || navigator.mozGetUserMedia


// array posities van de vingerkootjes
let fingerLookupIndices = {
    thumb: [0, 1, 2, 3, 4],
    indexFinger: [0, 5, 6, 7, 8],
    middleFinger: [0, 9, 10, 11, 12],
    ringFinger: [0, 13, 14, 15, 16],
    pinky: [0, 17, 18, 19, 20]
}


//
// start de applicatie
//
async function main() {
    model = await handpose.load()
    const video = await setupCamera()
    video.play()
    startLandmarkDetection(video)
}

async function ready(){
    console.log("game started")
    let data = await getData()

    data = data.slice(0,60)
    
    let predictHand = knn.classify(data)
    document.getElementById("begin").innerHTML = "Your hand: "+ predictHand + "!"

}

//
// start de webcam
//
async function setupCamera() {
    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        throw new Error(
            "Webcam not available"
        )
    }

    const video = document.getElementById("video")
    const stream = await navigator.mediaDevices.getUserMedia({
        audio: false,
        video: {
            facingMode: "user",
            width: VIDEO_WIDTH,
            height: VIDEO_HEIGHT
        }
    })
    video.srcObject = stream

    return new Promise(resolve => {
        video.onloadedmetadata = () => {
            resolve(video)
        }
    })
}

//
// predict de vinger posities in de video stream
//
async function startLandmarkDetection(video) {

    videoWidth = video.videoWidth
    videoHeight = video.videoHeight

    canvas = document.getElementById("output")

    canvas.width = videoWidth
    canvas.height = videoHeight

    ctx = canvas.getContext("2d")

    video.width = videoWidth
    video.height = videoHeight

    ctx.clearRect(0, 0, videoWidth, videoHeight)
    ctx.strokeStyle = "red"
    ctx.fillStyle = "red"

    ctx.translate(canvas.width, 0)
    ctx.scale(-1, 1) // video omdraaien omdat webcam in spiegelbeeld is

    predictLandmarks()
}

//
// predict de locatie van de vingers met het model
//
async function predictLandmarks() {
    ctx.drawImage(video,0,0,videoWidth,videoHeight,0,0,canvas.width,canvas.height)
    // prediction!
    const predictions = await model.estimateHands(video)
    if (predictions.length > 0) {
        const result = predictions[0].landmarks
        drawKeypoints(ctx, result, predictions[0].annotations)
        logData(predictions)

        console.log(predictions)
        currentPredictions = predictions
    }

    // 60 keer per seconde is veel, gebruik setTimeout om minder vaak te predicten
    requestAnimationFrame(predictLandmarks)

    // setTimeout(()=>predictLandmarks(), 1000)
}

//
// toon de eerste 20 waarden in een log - elk punt heeft een X, Y, Z waarde
//
function logData(predictions) {
    let str = ""
    // console.log(predictions[0].landmarks)
    for (let i = 0; i < 20; i++) {
        str += predictions[0].landmarks[i][0] + ", " + predictions[0].landmarks[i][1] + ", " + predictions[0].landmarks[i][2] + ", "
    }
    // log.innerText = str
}

//
// teken hand en vingers
//
function drawKeypoints(ctx, keypoints) {
    const keypointsArray = keypoints;

    for (let i = 0; i < keypointsArray.length; i++) {
        const y = keypointsArray[i][0]
        const x = keypointsArray[i][1]
        drawPoint(ctx, x - 2, y - 2, 3)
    }

    const fingers = Object.keys(fingerLookupIndices)
    for (let i = 0; i < fingers.length; i++) {
        const finger = fingers[i]
        const points = fingerLookupIndices[finger].map(idx => keypoints[idx])
        drawPath(ctx, points, false)
    }
}

//
// teken een punt
//
function drawPoint(ctx, y, x, r) {
    ctx.beginPath()
    ctx.arc(x, y, r, 0, 2 * Math.PI)
    ctx.fill()
}
//
// teken een lijn
//
function drawPath(ctx, points, closePath) {
    const region = new Path2D()
    region.moveTo(points[0][0], points[0][1])
    for (let i = 1; i < points.length; i++) {
        const point = points[i]
        region.lineTo(point[0], point[1])
    }

    if (closePath) {
        region.closePath()
    }
    ctx.stroke(region)
}

async function getData() {
    if(currentPredictions.length > 0) {
        let result = []
        for (const landmark of currentPredictions[0].landmarks) {
            for (const datapoint of landmark) {
                result.push(datapoint)
            }
        }
        return result
    } else {
        return []
    }
}
//
// start
//
main()

